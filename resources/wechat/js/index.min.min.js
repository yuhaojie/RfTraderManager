var initScreen=function(b){$("html").css("font-size",document.documentElement.clientWidth/375*312.5+"%");if(b){b()}};document.onreadystatechange=function(b){document.body.style.display="block";$("#wrap").addClass("show")};function Toast(f,d){d=isNaN(d)?3000:d;var e=document.createElement("div");e.innerHTML=f;e.style.cssText="width:60%; min-width:3rem; background:rgba(0,0,0,0.5);height:0.8rem; color:#fff; line-height:0.8rem; font-size:0.24rem;text-align:center; border-radius:0.2rem; position:fixed; top:40%; left:20%; z-index:999999;";document.body.appendChild(e);setTimeout(function(){var a=0.5;e.style.webkitTransition="-webkit-transform "+a+"s ease-in, opacity "+a+"s ease-in";e.style.opacity="0";setTimeout(function(){document.body.removeChild(e)},a*1000)},d)}template.config("openTag","<%");template.config("closeTag","%>");$(function(){initScreen();var k=[path+"audio/bgm.mp3"];if(/micromessenger/i.test(navigator.userAgent.toLowerCase())){document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.invoke("getNetworkType",{},function(a){voice=audio.create({audio:k,autoPlay:true,loop:true,end:function(b,c){}})})},false)}else{voice=audio.create({audio:k,autoPlay:true,loop:true,end:function(a,b){}})}window.addEventListener("resize",function(a){initScreen()},false);var i=[{x:0.1,y:-0.7},{x:1.5,y:-0.7},{x:2.9,y:-0.7},{x:4.3,y:-0.7},{x:5.7,y:-0.7},{x:5.7,y:0.9},{x:4.3,y:0.9},{x:2.9,y:0.9},{x:1.5,y:0.9},{x:0.1,y:0.9},{x:0.1,y:2.5},{x:1.5,y:2.5},{x:2.9,y:2.5},{x:4.3,y:2.5},{x:5.7,y:2.5},{x:5.7,y:4.1},{x:4.3,y:4.1},{x:2.9,y:4.1}];$(".person").css({left:i[signInDays].x+"rem",top:i[signInDays].y+"rem"});if(signed){$(".signIn").hide();$(".signed").show()}else{$(".signed").hide();$(".signIn").show()}var h=function(a){$(".modal").show();setTimeout(function(){$(".modal").addClass("show")},30);$(a).addClass("show")};var l=function(a){};$(".modal,.btn-sure").click(function(){$(".modal").removeClass("show");setTimeout(function(){$(".modal").hide()},300);$(".layer").removeClass("show")});$(".play").click(function(){$(this).toggleClass("pause");voice.playPause()});$(".myPrize").click(function(){j();h(".layer-7")});var m=false;$(".signIn").click(function(){if(signInDays==17){return}if(m){return}m=true;if(isMember){if(isStart==false){h(".layer-5");m=false;return}if(isEnd==true){h(".layer-6");m=false;return}signInDays++;$(".person").css({left:i[signInDays].x+"rem",top:i[signInDays].y+"rem"});n()}else{h(".layer-1")}});function n(){$.ajax({type:"get",url:signUrl,dataType:"json",data:{},success:function(a){if(a.code==200){if(a.data.award_cate_id==1){$(".layer-2 .score").text(a.data.award_title);h(".layer-2")}else{$(".layer-3 p").text(a.data.award_title);h(".layer-3")}}else{h(".layer-4")}m=false;$(".footer span").text(signInDays);signed=true;$(".signIn").hide();$(".signed").show()},error:function(a,b,c){Toast(c,2000);m=false}})}function j(){$.ajax({type:"get",url:recordUrl,dataType:"json",data:{},success:function(a){var b=template("listTpl",a.data);$(".layer-7 ul").html(b)}})}});