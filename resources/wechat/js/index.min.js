var initScreen=function(a){$("html").css("font-size",document.documentElement.clientWidth/375*312.5+"%");if(a){a()}};document.onreadystatechange=function(a){document.body.style.display="block";$("#wrap").addClass("show")};function Toast(c,b){b=isNaN(b)?3000:b;var a=document.createElement("div");a.innerHTML=c;a.style.cssText="width:60%; min-width:3rem; background:rgba(0,0,0,0.5);height:0.8rem; color:#fff; line-height:0.8rem; font-size:0.24rem;text-align:center; border-radius:0.2rem; position:fixed; top:40%; left:20%; z-index:999999;";document.body.appendChild(a);setTimeout(function(){var e=0.5;a.style.webkitTransition="-webkit-transform "+e+"s ease-in, opacity "+e+"s ease-in";a.style.opacity="0";setTimeout(function(){document.body.removeChild(a)},e*1000)},b)}template.config("openTag","<%");template.config("closeTag","%>");$(function(){initScreen();var f=[path+"audio/bgm.mp3"];if(/micromessenger/i.test(navigator.userAgent.toLowerCase())){document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.invoke("getNetworkType",{},function(h){voice=audio.create({audio:f,autoPlay:true,loop:true,end:function(j,i){}})})},false)}else{voice=audio.create({audio:f,autoPlay:true,loop:true,end:function(i,h){}})}window.addEventListener("resize",function(h){initScreen()},false);var a=[{x:0.1,y:-0.7},{x:1.5,y:-0.7},{x:2.9,y:-0.7},{x:4.3,y:-0.7},{x:5.7,y:-0.7},{x:5.7,y:0.9},{x:4.3,y:0.9},{x:2.9,y:0.9},{x:1.5,y:0.9},{x:0.1,y:0.9},{x:0.1,y:2.5},{x:1.5,y:2.5},{x:2.9,y:2.5},{x:4.3,y:2.5},{x:5.7,y:2.5},{x:5.7,y:4.1},{x:4.3,y:4.1},{x:2.9,y:4.1}];$(".person").css({left:a[signInDays].x+"rem",top:a[signInDays].y+"rem"});if(signed){$(".signIn").hide();$(".signed").show()}else{$(".signed").hide();$(".signIn").show()}var b=function(h){$(".modal").show();setTimeout(function(){$(".modal").addClass("show")},30);$(h).addClass("show")};var e=function(h){};$(".modal,.btn-sure").click(function(){$(".modal").removeClass("show");setTimeout(function(){$(".modal").hide()},300);$(".layer").removeClass("show")});$(".play").click(function(){$(this).toggleClass("pause");voice.playPause()});$(".myPrize").click(function(){g();b(".layer-7")});var d=false;$(".signIn").click(function(){if(signInDays==17){return}if(d){return}d=true;if(isMember){if(isStart==false){b(".layer-5");d=false;return}if(isEnd==true){b(".layer-6");d=false;return}signInDays++;$(".person").css({left:a[signInDays].x+"rem",top:a[signInDays].y+"rem"});c()}else{b(".layer-1")}});function c(){$.ajax({type:"get",url:signUrl,dataType:"json",data:{},success:function(h){if(h.code==200){if(h.data.award_cate_id==1){$(".layer-2 .score").text(h.data.award_title);b(".layer-2")}else{$(".layer-3 p").text(h.data.award_title);b(".layer-3")}}else{b(".layer-4")}d=false;$(".footer span").text(signInDays);signed=true;$(".signIn").hide();$(".signed").show()},error:function(j,i,h){Toast(h,2000);d=false}})}function g(){$.ajax({type:"get",url:recordUrl,dataType:"json",data:{},success:function(i){var h=template("listTpl",i.data);$(".layer-7 ul").html(h)}})}});